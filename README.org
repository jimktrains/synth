* J-Synth (Jim's Synth)

** Goals

*** Design the internals so that it can be ported to an AVR or ARM microcontroller

Ideally this would mean avoiding floating point. However, we can use
  fixed-point operations (Q1.7) and integer operations. Ideally casting
  would be limited. However, since the AVRs, x86, &c allow for/require
  the product to be twice the size of the multiplicands, and the only way to
  represent that is casting, and since I'll make use of that
  to do the fixed point arithmetic, I'll use casts there. (See [[Notes on
  fixed-point arithmetic]] later on.)

*** Mimic a modular synth
Notes:

- Modular synths use 10v peak to peak (-5v to 5v).
- Modular synths use a 1v/octave convention

I'm going to assume an 8 bit ADC and DAC [fn:1] [fn:3] will be processing the
  control voltages. As such, each volt is roughly 25 steps in the DAC
  (10v / 256 steps = .0390625v / step, so 0.4v / step would give 250
  steps for 10v). [fn:2]

[fn:1] As of, `8e9fd93`, I'm assuming that the ADC does -128 = -5v and 127 = 5v. It
  may be better to assume it's an unsigned value and 0 = -5v.

[fn:2] As of `8e9fd93`, I'm assuming that each volt is 12 steps,
  however, I will need to change my cv to frequency mapping.

[fn:3] If I move to assuming 10bit AC, then it's roughly 0.01v (.009765625v) /
  step. This gives ~100 step/v. This gives us tremendously better
  accuracy in terms of pitch on a Twelve-tone Equal Temperament Scale.

** <<<Notes on fixed-point aritmetic>>>

See
  [[https://www.microchip.com/wwwAppNotes/AppNotes.aspx?appnote=en591233][AVR201:
  Using the 8-bit AVR Hardware Multiplier]] for details on the AVR
  implementation.


- FMULS
#+BEGIN_SRC
$B0 * $40 = $D800 (remember, AVR stores little endian, so 00:D8)
1011:0000 * 0100:0000 = 1101:1000 0000:0000
-0.625 * 0.5 = -.3125
-0.625 * 64 = -40
-80 * 0.5 = -40
#+END_SRC

- MULS

#+BEGIN_SRC
$B0 * $40 = $EC00 (remember, AVR stores little endian, so 00:D8)
1011:0000 * 0100:0000 = 1110:1100  0000:0000
-80 * 64 = -5120
#+END_SRC

** ADC table or errors

| n | N/25 | 2^n/25 |  | N/100 | 2^n/100 |  | N/12 | 2^n/12 |  | n |
  closest 25th | error |  | n | closest 100th | error|
|---+------+--------+--+-------+---------+--+------+--------+--+---+--------------+-------+--+---+---------------+------|
| 1 | 0.04 | 1.02811382665607 |  | 0.01 | 1.00695555005672 |  | 0.083333333333333 | 1.0594630943593 |  | 2 | 1.05701804056138 | 0.23% |  | 8 | 1.05701804056138 | 0.23%|
| 2 | 0.08 | 1.05701804056138 |  | 0.02 | 1.01395947979003 |  | 0.166666666666667 | 1.12246204830937 |  | 4 | 1.11728713807222 | 0.46% |  | 16 | 1.11728713807222 | 0.46%|
| 3 | 0.12 | 1.08673486252606 |  | 0.03 | 1.02101212570719 |  | 0.25 | 1.18920711500272 |  | 6 | 1.18099266142953 | 0.69% |  | 25 | 1.18920711500272 | 0.00%|
| 4 | 0.16 | 1.11728713807222 |  | 0.04 | 1.02811382665607 |  | 0.333333333333333 | 1.25992104989487 |  | 8 | 1.24833054890161 | 0.92% |  | 33 | 1.25701337452183 | 0.23%|
| 5 | 0.2 | 1.14869835499704 |  | 0.05 | 1.03526492384138 |  | 0.416666666666667 | 1.33483985417003 |  | 10 | 1.31950791077289 | 1.15% |  | 41 | 1.32868581409651 | 0.46%|
| 6 | 0.24 | 1.18099266142953 |  | 0.06 | 1.04246576084112 |  | 0.5 | 1.4142135623731 |  | 12 | 1.39474366635041 | 1.38% |  | 50 | 1.4142135623731 | 0.00%|
| 7 | 0.28 | 1.21419488439505 |  | 0.07 | 1.04971668362307 |  | 0.583333333333333 | 1.49830707687668 |  | 14 | 1.4742692172911 | 1.60% |  | 58 | 1.49484924863494 | 0.23%|
| 8 | 0.32 | 1.24833054890161 |  | 0.08 | 1.05701804056138 |  | 0.666666666666667 | 1.5874010519682 |  | 16 | 1.558329159321 | 1.83% |  | 66 | 1.58008262372675 | 0.46%|
| 9 | 0.36 | 1.2834258975629 |  | 0.09 | 1.06437018245336 |  | 0.75 | 1.68179283050743 |  | 18 | 1.64718203453515 | 2.06% |  | 75 | 1.68179283050743 | 0.00%|
| 10 | 0.4 | 1.31950791077289 |  | 0.1 | 1.07177346253629 |  | 0.833333333333333 | 1.78179743628068 |  | 20 | 1.74110112659225 | 2.28% |  | 83 | 1.77768536233314 | 0.23%|
| 11 | 0.44 | 1.35660432744767 |  | 0.11 | 1.07922823650443 |  | 0.916666666666667 | 1.88774862536339 |  | 22 | 1.84037530124975 | 2.51% |  | 91 | 1.87904549842802 | 0.46%|
| 12 | 0.48 | 1.39474366635041 |  | 0.12 | 1.08673486252606|
| 13 | 0.52 | 1.43395524801583 |  | 0.13 | 1.09429370126074|
| 14 | 0.56 | 1.4742692172911 |  | 0.14 | 1.10190511587661|
| 15 | 0.6 | 1.5157165665104 |  | 0.15 | 1.10956947206785|
| 16 | 0.64 | 1.558329159321 |  | 0.16 | 1.11728713807222|
| 17 | 0.68 | 1.60213975517924 |  | 0.17 | 1.12505848468881|
| 18 | 0.72 | 1.64718203453515 |  | 0.18 | 1.1328838852958|
| 19 | 0.76 | 1.69349062472505 |  | 0.19 | 1.14076371586842|
| 20 | 0.8 | 1.74110112659225 |  | 0.2 | 1.14869835499704|
| 21 | 0.84 | 1.79005014185595 |  | 0.21 | 1.15668818390529|
| 22 | 0.88 | 1.84037530124975 |  | 0.22 | 1.16473358646846|
| 23 | 0.92 | 1.89211529345119 |  | 0.23 | 1.17283494923188|
| 24 | 0.96 | 1.94530989482457 |  | 0.24 | 1.18099266142953|
| 25 |  |  |  | 0.25 | 1.18920711500272|
| 26 |  |  |  | 0.26 | 1.19747870461893|
| 27 |  |  |  | 0.27 | 1.20580782769076|
| 28 |  |  |  | 0.28 | 1.21419488439505|
| 29 |  |  |  | 0.29 | 1.22264027769207|
| 30 |  |  |  | 0.3 | 1.23114441334492|
| 31 |  |  |  | 0.31 | 1.23970769993899|
| 32 |  |  |  | 0.32 | 1.24833054890161|
| 33 |  |  |  | 0.33 | 1.25701337452183|
| 34 |  |  |  | 0.34 | 1.26575659397028|
| 35 |  |  |  | 0.35 | 1.27456062731926|
| 36 |  |  |  | 0.36 | 1.2834258975629|
| 37 |  |  |  | 0.37 | 1.29235283063749|
| 38 |  |  |  | 0.38 | 1.30134185544193|
| 39 |  |  |  | 0.39 | 1.31039340385836|
| 40 |  |  |  | 0.4 | 1.31950791077289|
| 41 |  |  |  | 0.41 | 1.32868581409651|
| 42 |  |  |  | 0.42 | 1.33792755478611|
| 43 |  |  |  | 0.43 | 1.34723357686569|
| 44 |  |  |  | 0.44 | 1.35660432744767|
| 45 |  |  |  | 0.45 | 1.3660402567544|
| 46 |  |  |  | 0.46 | 1.37554181813974|
| 47 |  |  |  | 0.47 | 1.38510946811092|
| 48 |  |  |  | 0.48 | 1.39474366635041|
| 49 |  |  |  | 0.49 | 1.404444875738|
| 50 |  |  |  | 0.5 | 1.4142135623731|
| 51 |  |  |  | 0.51 | 1.42405019559707|
| 52 |  |  |  | 0.52 | 1.43395524801583|
| 53 |  |  |  | 0.53 | 1.4439291955225|
| 54 |  |  |  | 0.54 | 1.45397251732031|
| 55 |  |  |  | 0.55 | 1.46408569594563|
| 56 |  |  |  | 0.56 | 1.4742692172911|
| 57 |  |  |  | 0.57 | 1.48452357062905|
| 58 |  |  |  | 0.58 | 1.49484924863494|
| 59 |  |  |  | 0.59 | 1.50524674741107|
| 60 |  |  |  | 0.6 | 1.5157165665104|
| 61 |  |  |  | 0.61 | 1.52625920896056|
| 62 |  |  |  | 0.62 | 1.53687518128801|
| 63 |  |  |  | 0.63 | 1.54756499354239|
| 64 |  |  |  | 0.64 | 1.558329159321|
| 65 |  |  |  | 0.65 | 1.5691681957935|
| 66 |  |  |  | 0.66 | 1.58008262372675|
| 67 |  |  |  | 0.67 | 1.59107296750984|
| 68 |  |  |  | 0.68 | 1.60213975517924|
| 69 |  |  |  | 0.69 | 1.61328351844425|
| 70 |  |  |  | 0.7 | 1.62450479271247|
| 71 |  |  |  | 0.71 | 1.63580411711556|
| 72 |  |  |  | 0.72 | 1.64718203453515|
| 73 |  |  |  | 0.73 | 1.65863909162888|
| 74 |  |  |  | 0.74 | 1.67017583885674|
| 75 |  |  |  | 0.75 | 1.68179283050743|
| 76 |  |  |  | 0.76 | 1.69349062472505|
| 77 |  |  |  | 0.77 | 1.70526978353591|
| 78 |  |  |  | 0.78 | 1.71713087287551|
| 79 |  |  |  | 0.79 | 1.72907446261573|
| 80 |  |  |  | 0.8 | 1.74110112659225|
| 81 |  |  |  | 0.81 | 1.75321144263207|
| 82 |  |  |  | 0.82 | 1.76540599258131|
| 83 |  |  |  | 0.83 | 1.77768536233314|
| 84 |  |  |  | 0.84 | 1.79005014185595|
| 85 |  |  |  | 0.85 | 1.80250092522166|
| 86 |  |  |  | 0.86 | 1.81503831063432|
| 87 |  |  |  | 0.87 | 1.8276629004588|
| 88 |  |  |  | 0.88 | 1.84037530124975|
| 89 |  |  |  | 0.89 | 1.85317612378074|
| 90 |  |  |  | 0.9 | 1.86606598307361|
| 91 |  |  |  | 0.91 | 1.87904549842802|
| 92 |  |  |  | 0.92 | 1.89211529345119|
| 93 |  |  |  | 0.93 | 1.90527599608788|
| 94 |  |  |  | 0.94 | 1.91852823865053|
| 95 |  |  |  | 0.95 | 1.93187265784969|
| 96 |  |  |  | 0.96 | 1.94530989482457|
| 97 |  |  |  | 0.97 | 1.95884059517385|
| 98 |  |  |  | 0.98 | 1.97246540898672|
| 99 |  |  |  | 0.99 | 1.98618499087407|
